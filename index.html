<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hedbera Timer</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&display=swap"
    rel="stylesheet"
  />
  <style>
    :root {
      --color-dark-blue: #0d1b2a;
      --color-light-blue: #1b263b;
      --color-white: #ffffff;
      --color-grey: #778da9;
      --color-bg: #415a77;
      --color-twitter: #1da1f2;
      --color-gmail: #d14836;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: "Rubik", sans-serif;
    }

    body {
      background-color: var(--color-dark-blue);
      color: var(--color-white);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      padding: 2rem;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 1rem;
    }

    p.subheading {
      font-size: 1.2rem;
      color: var(--color-grey);
      margin-bottom: 2rem;
      text-align: center;
      max-width: 600px;
    }

    .mode-buttons {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .mode-buttons button {
      padding: 0.8rem 2rem;
      border: none;
      background-color: var(--color-light-blue);
      color: var(--color-white);
      font-weight: bold;
      text-transform: uppercase;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 8px;
      transition: background-color 0.3s ease;
    }

    .mode-buttons button.active,
    .mode-buttons button:hover {
      background-color: var(--color-grey);
      color: var(--color-bg);
    }

    .timer {
      font-size: 6rem;
      font-weight: bold;
      margin-bottom: 1.5rem;
    }

    .controls {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .controls button {
      padding: 0.8rem 2rem;
      border: none;
      background-color: var(--color-white);
      color: var(--color-dark-blue);
      font-weight: bold;
      text-transform: uppercase;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 8px;
      transition: background-color 0.3s ease;
    }

    .controls button:hover {
      background-color: var(--color-grey);
      color: var(--color-bg);
    }

    #total-time {
      margin-top: 1rem;
      color: var(--color-grey);
      font-weight: bold;
      cursor: pointer;
      user-select: none;
    }

    /* Social links container */
    .social-links {
      margin-top: 2rem;
      display: flex;
      gap: 1.5rem;
    }

    .social-link {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background-color: var(--color-light-blue);
      cursor: pointer;
      transition: background-color 0.3s ease;
      text-decoration: none;
    }

    .social-link:hover {
      background-color: var(--color-grey);
    }

    .social-link svg {
      width: 20px;
      height: 20px;
      fill: var(--color-white);
    }

    .social-link.twitter:hover svg {
      fill: var(--color-twitter);
    }

    .social-link.gmail:hover svg {
      fill: var(--color-gmail);
    }
  </style>
</head>
<body>
  <h1>Hedbera Timer</h1>
  <p class="subheading">An online Timer to boost your productivity</p>

  <div class="mode-buttons">
    <button class="active" onclick="setMode('pomodoro')">Pomodoro</button>
    <button onclick="setMode('short')">Short Break</button>
    <button onclick="setMode('long')">Long Break</button>
  </div>

  <div class="timer" id="timer">25:00</div>
  <div class="controls">
    <p id="total-time"></p>
    <button onclick="startTimer()">Start</button>
    <button onclick="pauseTimer()">Pause</button>
  </div>

  <!-- Social Icons -->
  <div class="social-links">
    <a
      href="https://x.com/MirMohmadLuqman"
      target="_blank"
      rel="noopener noreferrer"
      class="social-link twitter"
      title="Follow me on X (Twitter)"
      aria-label="Twitter"
      ><svg viewBox="0 0 24 24" aria-hidden="true">
        <path
          d="M23.954 4.569c-.885.39-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.95.564-2.005.974-3.127 1.195-.897-.959-2.178-1.559-3.594-1.559-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616v.061c0 2.388 1.697 4.384 3.946 4.832-.734.2-1.512.232-2.224.084.626 1.956 2.444 3.377 4.6 3.415-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.961-.695 1.8-1.562 2.46-2.549z"
        ></path>
      </svg></a
    >
    <a
      href="mailto:mirmohmmadluqman@gmail.com"
      class="social-link gmail"
      title="Send me an email"
      aria-label="Gmail"
      ><svg viewBox="0 0 24 24" aria-hidden="true">
        <path
          d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"
        ></path>
      </svg></a
    >
  </div>

  <audio id="alarm" src="Elements/sound.mp3"></audio>

  <script>
    let timer;
    let time = 1500;
    let mode = "pomodoro";
    let isRunning = false;

    function getTodayKey() {
      const today = new Date();
      return today.toISOString().split("T")[0]; // yyyy-mm-dd
    }

    function getMonthKey() {
      const now = new Date();
      return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, "0")}`; // yyyy-mm
    }

    function getYearKey() {
      return `${new Date().getFullYear()}`; // yyyy
    }

    function updateTimerDisplay() {
      const minutes = Math.floor(time / 60)
        .toString()
        .padStart(2, "0");
      const seconds = (time % 60).toString().padStart(2, "0");
      document.getElementById("timer").textContent = `${minutes}:${seconds}`;
    }

    function updateTotalTimeDisplay() {
      const allData = JSON.parse(localStorage.getItem("focusData")) || {};
      const todayKey = getTodayKey();
      const mins = Math.floor((allData[todayKey] || 0) / 60);
      document.getElementById("total-time").textContent = `Focused Time: ${mins} min`;
    }

    function startTimer() {
      if (isRunning) return;
      isRunning = true;
      timer = setInterval(() => {
        time--;
        updateTimerDisplay();
        if (time <= 0) {
          clearInterval(timer);
          document.getElementById("alarm").play();
          isRunning = false;
          recordFocusTime(1500);
          autoSwitchMode();
        }
      }, 1000);
    }

    function pauseTimer() {
      clearInterval(timer);
      if (isRunning && mode === "pomodoro") {
        const used = 1500 - time;
        recordFocusTime(used);
      }
      isRunning = false;
    }

    function setMode(newMode) {
      document.querySelectorAll(".mode-buttons button").forEach((btn) => btn.classList.remove("active"));
      event.target.classList.add("active");
      mode = newMode;
      time = mode === "pomodoro" ? 1500 : mode === "short" ? 300 : 900;
      updateTimerDisplay();
      pauseTimer();
    }

    function autoSwitchMode() {
      if (mode === "pomodoro") {
        setMode("short");
        startTimer();
      } else {
        setMode("pomodoro");
        startTimer();
      }
    }

    function recordFocusTime(seconds) {
      if (mode !== "pomodoro") return;

      const data = JSON.parse(localStorage.getItem("focusData")) || {};
      const todayKey = getTodayKey();
      const monthKey = getMonthKey();
      const yearKey = getYearKey();

      // Update today's data
      data[todayKey] = (data[todayKey] || 0) + seconds;

      // Check for month rollover
      const storedMonth = localStorage.getItem("lastMonthKey");
      if (storedMonth && storedMonth !== monthKey) {
        let monthTotal = 0;
        for (const key in data) {
          if (key.startsWith(storedMonth)) {
            monthTotal += data[key];
            delete data[key];
          }
        }
        data[`month-${storedMonth}`] = monthTotal;
      }
      localStorage.setItem("lastMonthKey", monthKey);

      // Check for year rollover
      const storedYear = localStorage.getItem("lastYearKey");
      if (storedYear && storedYear !== yearKey) {
        let yearTotal = 0;
        for (const key in data) {
          if (key.startsWith(`month-${storedYear}`)) {
            yearTotal += data[key];
            delete data[key];
          }
        }
        data[`year-${storedYear}`] = yearTotal;
      }
      localStorage.setItem("lastYearKey", yearKey);

      localStorage.setItem("focusData", JSON.stringify(data));
      updateTotalTimeDisplay();
    }

    function showFocusBreakdown() {
      const data = JSON.parse(localStorage.getItem("focusData")) || {};
      let breakdown = "";
      for (const key in data) {
        const mins = Math.floor(data[key] / 60);
        if (key.startsWith("year-")) {
          breakdown += `ðŸ—“ï¸ Year ${key.split("-")[1]}: ${mins} min\n`;
        } else if (key.startsWith("month-")) {
          breakdown += `ðŸ“… Month ${key.split("-")[1]}: ${mins} min\n`;
        } else {
          breakdown += `ðŸ“Œ ${key}: ${mins} min\n`;
        }
      }
      alert(breakdown || "No focus data yet.");
    }

    document.addEventListener("DOMContentLoaded", () => {
      updateTimerDisplay();
      updateTotalTimeDisplay();
      document.getElementById("total-time").addEventListener("click", showFocusBreakdown);
    });
  </script>
</body>
</html>
